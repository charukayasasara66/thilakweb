<!DOCTYPE html>
<html lang="si" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
    <title>තිලක් ජයසිංහ | Premium Science Education</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Abhaya+Libre:wght@400;500;600;700;800&family=Noto+Sans+Sinhala:wght@300;400;500;600;700;800&family=Poppins:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { 
                        sans: ['"Poppins"', '"Noto Sans Sinhala"', 'sans-serif'],
                        serif: ['"Abhaya Libre"', 'serif'],
                    },
                    colors: { brand: { dark: '#020617', primary: '#3b82f6', accent: '#06b6d4' } },
                    animation: { 
                        'float-slow': 'float 6s ease-in-out infinite',
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        float: { '0%, 100%': { transform: 'translateY(0)' }, '50%': { transform: 'translateY(-15px)' } }
                    }
                }
            }
        }
    </script>
    <style>
        /* FIX 1: Force width constraints for mobile browsers */
        html, body {
            width: 100%;
            overflow-x: hidden;
            position: relative;
            background-color: #020617; 
            color: #f8fafc; 
            font-family: 'Poppins', 'Noto Sans Sinhala', sans-serif;
            -webkit-text-size-adjust: 100%;
            -webkit-tap-highlight-color: transparent;
        }
        
        .bg-grain {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.05'/%3E%3C/svg%3E");
            pointer-events: none; z-index: 1; opacity: 0.4;
        }

        .ambient-glow {
            position: absolute; width: 600px; height: 600px;
            background: radial-gradient(circle, rgba(6,182,212,0.15) 0%, rgba(0,0,0,0) 70%);
            border-radius: 50%; pointer-events: none; z-index: 0;
        }

        .liquid-glass { 
            background: rgba(255, 255, 255, 0.03); 
            backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08); border-top: 1px solid rgba(255, 255, 255, 0.15); 
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); 
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform: translateZ(0);
        }
        .liquid-glass:hover {
            background: rgba(255, 255, 255, 0.06); border-color: rgba(6, 182, 212, 0.3);
            box-shadow: 0 20px 40px -10px rgba(6, 182, 212, 0.15);
        }

        .modal-bubble { 
            background: rgba(10, 15, 30, 0.95); 
            box-shadow: 0 0 50px rgba(0,0,0,0.8), inset 0 0 0 1px rgba(255,255,255,0.1); 
            backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            transition: opacity 0.3s ease, transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1); 
        }

        .water-input { 
            background: rgba(0, 0, 0, 0.4); border: 1px solid rgba(255, 255, 255, 0.1); color: white; transition: all 0.3s ease; 
        }
        .water-input:focus { 
            background: rgba(6, 182, 212, 0.05); border-color: #06b6d4; outline: none; box-shadow: 0 0 20px rgba(6, 182, 212, 0.2); 
        }

        .glass-table-row { border-bottom: 1px solid rgba(255,255,255,0.05); transition: background 0.2s; }
        .glass-table-row:hover { background: rgba(6, 182, 212, 0.05); }
        .hidden-row { display: none !important; }

        /* --- MOBILE OPTIMIZED TABLE STYLES --- */
        @media (max-width: 768px) {
            #timetable-content table, #timetable-content thead, #timetable-content tbody, 
            #timetable-content th, #timetable-content td, #timetable-content tr { display: block; }
            #timetable-content thead tr { position: absolute; top: -9999px; left: -9999px; }
            #timetable-content tr { 
                border: 1px solid rgba(255,255,255,0.1); margin-bottom: 15px; 
                border-radius: 16px; background: rgba(255,255,255,0.03); padding: 15px; 
            }
            #timetable-content td { 
                border: none; border-bottom: 1px solid rgba(255,255,255,0.05); position: relative; 
                padding: 12px 0; display: flex; justify-content: space-between; align-items: center; text-align: right; 
            }
            #timetable-content td:last-child { border-bottom: 0; }
            #timetable-content td::before { 
                content: attr(data-label); font-weight: 700; color: #06b6d4; 
                text-transform: uppercase; font-size: 0.75rem; letter-spacing: 0.05em; text-align: left; 
            }
        }

        .video-container {
            position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;
            border-radius: 1.5rem; border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 20px 50px rgba(0,0,0,0.6);
        }
        .video-container video, .video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        .video-bg-wrapper { position: absolute; inset: 0; z-index: 0; overflow: hidden; }
        .video-bg-wrapper video { width: 100%; height: 100%; object-fit: cover; opacity: 0.4; filter: contrast(1.1) brightness(0.8); }
        .video-overlay { position: absolute; inset: 0; background: linear-gradient(to bottom, #020617 0%, rgba(2,6,23,0.4) 50%, #020617 100%); }
        .custom-scrollbar::-webkit-scrollbar { height: 6px; width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.02); }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(6, 182, 212, 0.3); border-radius: 10px; }
        #nav-bubble { background: linear-gradient(90deg, rgba(6,182,212,0.2) 0%, rgba(59,130,246,0.2) 100%); border: 1px solid rgba(255,255,255,0.2); transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1); backdrop-filter: blur(4px); -webkit-backdrop-filter: blur(4px); }
        select option { background-color: #020617; color: white; padding: 10px; }
    </style>
</head>
<body class="antialiased overflow-x-hidden selection:bg-cyan-500 selection:text-white">

    <div class="bg-grain"></div>
    <div class="ambient-glow top-0 left-0 opacity-30"></div>
    <div class="ambient-glow bottom-0 right-0 opacity-20 bg-blue-500"></div>

    <nav class="fixed top-4 md:top-6 left-0 right-0 z-50 flex justify-center px-4 pointer-events-none" data-aos="fade-down" data-aos-duration="1000">
        <div id="main-nav" class="relative liquid-glass px-3 py-2 rounded-full flex items-center justify-between pointer-events-auto overflow-hidden group border-white/10 w-full max-w-5xl">
            <div id="nav-bubble" class="absolute top-1 bottom-1 rounded-full z-0 opacity-0 w-0 transform translate-x-0"></div>
            
            <a href="#" class="nav-item relative z-10 px-4 py-2 text-lg md:text-xl font-bold text-white tracking-tight flex items-center gap-2" onclick="moveBubble(this)">
                තිලක් <span class="text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-500">ජයසිංහ</span>
            </a>
            
            <div class="hidden md:flex relative z-10 items-center">
                <a href="#about" class="nav-item px-6 py-2 text-sm font-medium text-slate-400 hover:text-white transition duration-300 rounded-full" onclick="moveBubble(this)">අප ගැන</a>
                <a href="#classes" class="nav-item px-6 py-2 text-sm font-medium text-slate-400 hover:text-white transition duration-300 rounded-full" onclick="moveBubble(this)">පන්ති</a>
                
                <button id="nav-login-btn" onclick="openLogin(this)" class="nav-item px-6 py-2 text-sm font-medium text-cyan-300 hover:text-white transition duration-300 rounded-full flex items-center gap-2">
                    <i class="fas fa-sign-in-alt"></i> Login
                </button>

                <button id="nav-announce-btn" onclick="openAnnouncement()" class="hidden nav-item px-4 py-2 text-slate-400 hover:text-white transition relative">
                    <i class="fas fa-bullhorn text-lg"></i>
                    <span id="announce-dot" class="absolute top-1 right-2 w-2.5 h-2.5 bg-red-500 rounded-full animate-ping hidden"></span>
                    <span id="announce-dot-static" class="absolute top-1 right-2 w-2.5 h-2.5 bg-red-500 rounded-full hidden"></span>
                </button>

                <div id="nav-user-profile" class="hidden flex items-center gap-4 pl-4">
                    <span class="text-white text-sm">Hi, <span id="user-name-display" class="font-bold text-cyan-400">Student</span></span>
                    <button onclick="handleLogout()" class="bg-red-500/10 border border-red-500/30 hover:bg-red-500/40 text-red-400 p-2 rounded-full transition" title="Logout"><i class="fas fa-sign-out-alt"></i></button>
                </div>
            </div>

            <div id="nav-reg-container" class="pl-2 pr-1 relative z-10 hidden md:block">
                <button id="nav-register-btn" onclick="openModal(this)" class="flex bg-gradient-to-r from-cyan-500/20 to-blue-500/20 border border-cyan-500/50 text-cyan-200 px-6 py-2 rounded-full text-sm font-bold hover:from-cyan-500 hover:to-blue-500 hover:text-white transition-all active:scale-95 shadow-[0_0_15px_rgba(6,182,212,0.3)]">Register</button>
            </div>

            <button class="md:hidden relative z-10 text-white p-2" onclick="toggleMobileMenu()">
                <i class="fas fa-bars text-xl"></i>
                <span id="mobile-menu-dot" class="absolute top-1 right-1 w-2.5 h-2.5 bg-red-500 rounded-full animate-ping hidden"></span>
            </button>
        </div>
    </nav>

    <div id="mobile-menu" class="fixed inset-0 z-40 bg-[#020617]/95 backdrop-blur-xl transform translate-x-full transition-transform duration-300 md:hidden flex flex-col items-center justify-center space-y-8">
        <button onclick="toggleMobileMenu()" class="absolute top-6 right-6 text-white text-2xl"><i class="fas fa-times"></i></button>
        
        <button id="mobile-announce-btn" onclick="toggleMobileMenu(); openAnnouncement()" class="hidden text-xl font-bold text-white flex items-center gap-3">
            <i class="fas fa-bullhorn text-cyan-400"></i> Announcements
            <span id="mobile-announce-dot" class="w-2.5 h-2.5 bg-red-500 rounded-full animate-pulse hidden"></span>
        </button>

        <a href="#about" onclick="toggleMobileMenu()" class="text-2xl font-bold text-white hover:text-cyan-400">අප ගැන</a>
        <a href="#classes" onclick="toggleMobileMenu()" class="text-2xl font-bold text-white hover:text-cyan-400">පන්ති</a>
        
        <button id="mobile-login-btn" onclick="toggleMobileMenu(); openLogin();" class="text-xl font-medium text-cyan-300 border border-cyan-500/30 px-8 py-3 rounded-full">Login</button>
        <button id="mobile-reg-btn" onclick="toggleMobileMenu(); openModal();" class="text-xl font-bold bg-gradient-to-r from-cyan-500 to-blue-600 text-white px-8 py-3 rounded-full">Register Now</button>
        
        <div id="mobile-user-profile" class="hidden text-center">
            <p class="text-white text-lg mb-4">Welcome, <span id="mobile-username-display" class="font-bold text-cyan-400">User</span></p>
            <button onclick="handleLogout()" class="text-red-400 border border-red-500/50 px-6 py-2 rounded-full">Logout</button>
        </div>
    </div>

    <a id="floating-wa-btn" href="#" target="_blank" class="hidden fixed bottom-32 md:bottom-28 right-4 md:right-8 z-[9999] flex items-center gap-3 bg-[#25D366] hover:bg-[#128C7E] text-white px-4 py-2 md:px-5 md:py-3 rounded-full font-bold shadow-[0_0_30px_rgba(37,211,102,0.4)] hover:-translate-y-1 transition-all duration-300 border border-white/20 animate-float-slow group transform-gpu">
        <i class="fab fa-whatsapp text-2xl md:text-3xl group-hover:rotate-12 transition-transform"></i>
        <div class="text-left leading-tight">
            <div class="text-[8px] md:text-[10px] text-white/80 uppercase tracking-wider font-bold">Missed Group?</div>
            <div class="text-xs md:text-sm font-bold">Join Now</div>
        </div>
    </a>

    <button onclick="openContact()" class="fixed bottom-16 md:bottom-8 right-4 md:right-8 z-[9999] flex items-center gap-3 bg-gradient-to-r from-blue-600 to-cyan-500 hover:from-blue-500 hover:to-cyan-400 text-white px-4 py-2 md:px-5 md:py-3 rounded-full font-bold shadow-[0_0_30px_rgba(6,182,212,0.6)] hover:shadow-[0_0_40px_rgba(6,182,212,0.8)] hover:-translate-y-1 transition-all duration-300 border border-white/20 animate-pulse-slow group transform-gpu">
        <i class="fas fa-headset text-2xl md:text-3xl group-hover:rotate-12 transition-transform"></i>
        <div class="text-left leading-tight">
            <div class="text-[8px] md:text-[10px] text-cyan-100 uppercase tracking-wider font-bold">Inquiries</div>
            <div class="text-xs md:text-sm font-bold">Contact Us</div>
        </div>
    </button>

    <div id="announce-overlay" class="fixed inset-0 z-[10000] flex items-center justify-center bg-black/90 backdrop-blur-xl hidden opacity-0 transition-opacity duration-300">
        <div id="announce-content" class="relative liquid-glass w-full max-w-lg mx-4 rounded-[2rem] p-8 transform scale-90 opacity-0 border border-red-500/30 shadow-[0_0_50px_rgba(239,68,68,0.2)] max-h-[85vh] overflow-y-auto custom-scrollbar">
            <button onclick="closeAnnouncement()" class="absolute top-5 right-6 text-slate-400 hover:text-white transition"><i class="fas fa-times text-xl"></i></button>
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-red-500/20 rounded-full mx-auto flex items-center justify-center mb-4 text-red-500 border border-red-500/50 animate-pulse"><i class="fas fa-bullhorn text-2xl"></i></div>
                <h2 class="text-2xl font-bold text-white">Announcements</h2>
                <p class="text-red-400 text-xs uppercase tracking-widest mt-1">Important Notices</p>
            </div>
            
            <div id="announce-list-container" class="space-y-4">
                <p class="text-center text-slate-500 text-sm">Loading...</p>
            </div>
        </div>
    </div>

    <div id="admin-announce-overlay" class="fixed inset-0 z-[10000] flex items-center justify-center bg-black/90 backdrop-blur-xl hidden opacity-0 transition-opacity duration-300">
        <div id="admin-announce-content" class="relative liquid-glass w-full max-w-lg mx-4 rounded-[2rem] p-8 transform scale-90 opacity-0 border border-cyan-500/30 max-h-[90vh] overflow-y-auto custom-scrollbar">
            <button onclick="closeAdminAnnouncement()" class="absolute top-5 right-6 text-slate-400 hover:text-white transition"><i class="fas fa-times text-xl"></i></button>
            <h2 class="text-2xl font-bold text-white mb-6">Manage Announcements</h2>
            
            <div class="mb-8">
                <label class="text-xs text-cyan-400 font-bold uppercase tracking-wider ml-1 mb-2 block">New Message</label>
                <textarea id="new-announce-text" rows="3" class="water-input w-full px-4 py-3 rounded-xl text-sm mb-4" placeholder="Type announcement here..."></textarea>
                <button onclick="publishAnnouncement()" class="w-full bg-gradient-to-r from-blue-600 to-cyan-500 text-white font-bold py-3 rounded-xl shadow-lg hover:scale-[1.02] transition">Publish Announcement</button>
            </div>

            <div class="border-t border-white/10 pt-6">
                <h3 class="text-white font-bold mb-4 text-sm">Active Announcements</h3>
                <div id="active-announce-list" class="space-y-3">
                    <p class="text-slate-500 text-sm text-center">Loading...</p>
                </div>
            </div>
        </div>
    </div>

    <div id="contact-overlay" class="fixed inset-0 z-[10000] flex items-center justify-center bg-black/90 backdrop-blur-xl hidden opacity-0 transition-opacity duration-300">
        <div id="contact-content" class="relative liquid-glass w-full max-w-sm mx-4 rounded-[2rem] p-8 transform scale-90 opacity-0 text-center border border-white/10 shadow-2xl">
            <button onclick="closeContact()" class="absolute top-5 right-6 text-slate-400 hover:text-white transition"><i class="fas fa-times text-xl"></i></button>
            <div class="w-16 h-16 bg-white/5 rounded-full mx-auto flex items-center justify-center mb-6 border border-white/10 text-cyan-400"><i class="fas fa-phone-volume text-2xl"></i></div>
            <h2 class="text-2xl font-bold text-white mb-2">Contact Us</h2>
            <p class="text-slate-400 text-xs mb-8">Click a number to call immediately.</p>
            <div class="space-y-4">
                <a href="tel:0718046043" class="block bg-gradient-to-r from-slate-800 to-slate-900 border border-white/10 p-4 rounded-xl hover:border-cyan-500/50 hover:from-slate-800 hover:to-slate-800 transition group">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-4">
                            <div class="w-10 h-10 rounded-full bg-cyan-500/10 flex items-center justify-center text-cyan-400 group-hover:bg-cyan-500 group-hover:text-white transition"><i class="fas fa-mobile-alt"></i></div>
                            <div class="text-left"><div class="text-[10px] text-slate-400 uppercase tracking-wider font-bold">Hotline 1</div><div class="text-lg font-bold text-white font-mono">071 804 6043</div></div>
                        </div>
                        <i class="fas fa-chevron-right text-slate-600 group-hover:text-cyan-400"></i>
                    </div>
                </a>
                <a href="tel:0779206009" class="block bg-gradient-to-r from-slate-800 to-slate-900 border border-white/10 p-4 rounded-xl hover:border-green-500/50 hover:from-slate-800 hover:to-slate-800 transition group">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-4">
                            <div class="w-10 h-10 rounded-full bg-green-500/10 flex items-center justify-center text-green-400 group-hover:bg-green-500 group-hover:text-white transition"><i class="fas fa-mobile-alt"></i></div>
                            <div class="text-left"><div class="text-[10px] text-slate-400 uppercase tracking-wider font-bold">Hotline 2</div><div class="text-lg font-bold text-white font-mono">077 920 6009</div></div>
                        </div>
                        <i class="fas fa-chevron-right text-slate-600 group-hover:text-green-400"></i>
                    </div>
                </a>
            </div>
        </div>
    </div>

    <div id="modal-overlay" class="fixed inset-0 z-[10000] flex items-center justify-center bg-black/80 backdrop-blur-md hidden opacity-0 transition-opacity duration-300">
        <div id="modal-content" class="relative modal-bubble w-full max-w-md mx-4 rounded-[2rem] p-8 transform scale-90 opacity-0 border border-white/10 overflow-y-auto max-h-[90vh]">
            <button onclick="closeModal()" class="absolute top-6 right-6 text-slate-500 hover:text-white transition transform hover:rotate-90"><i class="fas fa-times text-xl"></i></button>
            <div class="text-center mb-8">
                <div class="w-16 h-16 bg-gradient-to-tr from-cyan-500 to-blue-600 rounded-2xl rotate-3 mx-auto flex items-center justify-center mb-4 shadow-[0_0_30px_rgba(6,182,212,0.5)]"><i class="fas fa-user-graduate text-2xl text-white"></i></div>
                <h2 class="text-2xl font-bold text-white">New Student</h2>
                <p class="text-cyan-300/70 text-sm mt-1">Join the Premium Science Class</p>
            </div>
            <form id="reg-form" class="space-y-5" onsubmit="handleRegistration(event)">
                <div class="space-y-1"><label class="text-xs text-cyan-400 font-bold uppercase tracking-wider ml-1">Full Name</label><input id="reg-name" type="text" placeholder="Your Name" class="water-input w-full px-5 py-3.5 rounded-xl text-base md:text-sm" required></div>
                <div class="space-y-1"><label class="text-xs text-cyan-400 font-bold uppercase tracking-wider ml-1">WhatsApp (ID)</label><input id="reg-whatsapp" type="tel" placeholder="07X XXXXXXX" class="water-input w-full px-5 py-3.5 rounded-xl text-base md:text-sm" required></div>
                <div class="grid grid-cols-2 gap-4">
                    <div class="space-y-1"><label class="text-xs text-cyan-400 font-bold uppercase tracking-wider ml-1">Grade</label><select id="reg-grade" class="water-input w-full px-4 py-3.5 rounded-xl text-base md:text-sm appearance-none cursor-pointer bg-[#0f172a]" required><option value="">Select</option><option value="6">Grade 6</option><option value="7">Grade 7</option><option value="8">Grade 8</option><option value="9">Grade 9</option><option value="10">Grade 10</option><option value="11">Grade 11</option></select></div>
                    <div class="space-y-1" id="method-section"><label class="text-xs text-cyan-400 font-bold uppercase tracking-wider ml-1">Method</label><select id="reg-method" class="water-input w-full px-4 py-3.5 rounded-xl text-base md:text-sm appearance-none cursor-pointer bg-[#0f172a]" required><option value="">Select</option><option value="online">Online</option><option value="physical">Physical</option></select></div>
                </div>
                <button type="submit" id="reg-submit-btn" class="w-full bg-gradient-to-r from-blue-600 to-cyan-500 text-white font-bold py-4 rounded-xl shadow-[0_10px_30px_-10px_rgba(6,182,212,0.6)] hover:shadow-[0_10px_40px_-5px_rgba(6,182,212,0.8)] hover:scale-[1.02] transition-all transform active:scale-95 mt-4">Register Now</button>
            </form>
        </div>
    </div>

    <div id="cred-overlay" class="fixed inset-0 z-[10000] flex items-center justify-center bg-black/90 backdrop-blur-xl hidden opacity-0 transition-opacity duration-300">
        <div id="cred-content" class="relative liquid-glass w-full max-w-sm mx-4 rounded-[2rem] p-10 transform scale-90 opacity-0 text-center border border-green-500/30 shadow-[0_0_100px_rgba(34,197,94,0.2)]">
            <div class="w-20 h-20 bg-gradient-to-br from-green-400 to-green-600 rounded-full mx-auto flex items-center justify-center mb-6 shadow-[0_0_30px_rgba(34,197,94,0.6)] animate-bounce"><i class="fas fa-check text-3xl text-white"></i></div>
            <h2 class="text-3xl font-bold text-white mb-2">සාර්ථකයි!</h2>
            <p class="text-slate-400 text-sm mb-8">ගිණුමට පිවිසීමට මෙම විස්තර භාවිතා කරන්න.</p>
            <div class="space-y-3 mb-8">
                <div class="bg-white/5 border border-white/10 rounded-xl p-3"><p class="text-[10px] text-cyan-400 uppercase font-bold tracking-widest mb-1">USERNAME</p><p id="cred-username" class="text-2xl font-mono text-white tracking-widest font-bold">--</p></div>
                <div class="bg-white/5 border border-white/10 rounded-xl p-3"><p class="text-[10px] text-cyan-400 uppercase font-bold tracking-widest mb-1">PASSWORD</p><p id="cred-password" class="text-2xl font-mono text-white tracking-widest font-bold">--</p></div>
            </div>
            <button onclick="finalizeRegistration()" class="w-full bg-white text-black font-bold py-4 rounded-xl shadow-lg hover:bg-cyan-50 hover:scale-105 transition transform flex items-center justify-center gap-2">Go to WhatsApp <i class="fab fa-whatsapp text-lg"></i></button>
        </div>
    </div>

    <div id="login-overlay" class="fixed inset-0 z-[10000] flex items-center justify-center bg-black/80 backdrop-blur-md hidden opacity-0 transition-opacity duration-300">
        <div id="login-content" class="relative modal-bubble w-full max-w-md mx-4 rounded-[2rem] p-8 transform scale-90 opacity-0 border border-white/10">
            <button onclick="closeLogin()" class="absolute top-6 right-6 text-slate-500 hover:text-white transition transform hover:rotate-90"><i class="fas fa-times text-xl"></i></button>
            <div class="text-center mb-8"><h2 class="text-3xl font-bold text-white">Welcome Back</h2><p class="text-cyan-300/70 text-sm mt-1">Access Your Dashboard</p></div>
            <form id="login-form" class="space-y-5" onsubmit="handleLogin(event)">
                <div class="space-y-1"><label class="text-xs text-cyan-400 font-bold uppercase tracking-wider ml-1">Username</label><input id="login-username" type="text" placeholder="Phone + Grade" class="water-input w-full px-5 py-4 rounded-xl text-base md:text-sm" required></div>
                <div class="space-y-1"><label class="text-xs text-cyan-400 font-bold uppercase tracking-wider ml-1">Password</label><input id="login-password" type="password" placeholder="•••••••" class="water-input w-full px-5 py-4 rounded-xl text-base md:text-sm" required></div>
                <button type="submit" id="login-submit-btn" class="w-full bg-gradient-to-r from-cyan-600 to-blue-600 text-white font-bold py-4 rounded-xl shadow-[0_10px_30px_-10px_rgba(6,182,212,0.6)] hover:scale-[1.02] transition">Login Securely</button>
            </form>
        </div>
    </div>

    <div id="timetable-overlay" class="fixed inset-0 z-[10000] flex items-center justify-center bg-black/90 backdrop-blur-xl hidden opacity-0 transition-opacity duration-300">
        <div id="timetable-content" class="relative modal-bubble w-full max-w-3xl mx-4 rounded-[2rem] p-8 transform scale-90 opacity-0 overflow-hidden border border-white/10 max-h-[90vh] overflow-y-auto">
            <button onclick="closeTimeTable()" class="absolute top-6 right-6 text-slate-500 hover:text-white transition transform hover:rotate-90"><i class="fas fa-times text-xl"></i></button>
            <div class="text-center mb-8"><h2 class="text-3xl font-bold text-white mb-2">Class Schedule</h2><div class="w-16 h-1 bg-cyan-500 mx-auto rounded-full"></div></div>
            <div class="mb-6 flex justify-center">
                <div class="relative w-full max-w-xs">
                   <select id="timetable-filter" onchange="filterTimetable()" class="water-input w-full px-5 py-3 rounded-full text-center font-bold appearance-none bg-[#0f172a] cursor-pointer hover:border-cyan-500 transition text-base md:text-sm">
                    <option value="all">Show All Classes</option>
                    <option value="online">Online (Zoom)</option>
                    <option value="physical">Physical (Pawara)</option>
                    <option value="paper">Online Paper Class</option>
                </select>
                    <div class="absolute right-4 top-1/2 -translate-y-1/2 text-cyan-400 pointer-events-none"><i class="fas fa-chevron-down"></i></div>
                </div>
            </div>
            <div class="overflow-x-auto rounded-2xl md:border border-white/5">
                <table class="w-full text-left text-sm text-slate-300">
                    <thead class="text-xs uppercase bg-white/5 text-cyan-400 font-bold"><tr><th class="px-6 py-4">Grade</th><th class="px-6 py-4">Mode</th><th class="px-6 py-4">Day</th><th class="px-6 py-4">Time</th></tr></thead>
                    <tbody id="timetable-body" class="divide-y divide-white/5">
                        <tr class="glass-table-row" data-method="online"><td class="px-6 py-4 font-bold text-white" data-label="Grade">Grade 6</td><td class="px-6 py-4" data-label="Mode"><span class="bg-blue-500/20 text-blue-300 border border-blue-500/30 px-3 py-1 rounded-full text-xs">Online</span></td><td class="px-6 py-4" data-label="Day">Saturday</td><td class="px-6 py-4 text-white" data-label="Time">8:00 AM - 10:00 AM</td></tr>
                        <tr class="glass-table-row" data-method="online"><td class="px-6 py-4 font-bold text-white" data-label="Grade">Grade 7</td><td class="px-6 py-4" data-label="Mode"><span class="bg-blue-500/20 text-blue-300 border border-blue-500/30 px-3 py-1 rounded-full text-xs">Online</span></td><td class="px-6 py-4" data-label="Day">Saturday</td><td class="px-6 py-4 text-white" data-label="Time">10:30 AM - 12:30 PM</td></tr>
                        <tr class="glass-table-row" data-method="physical"><td class="px-6 py-4 font-bold text-white" data-label="Grade">Grade 8</td><td class="px-6 py-4" data-label="Mode"><span class="bg-purple-500/20 text-purple-300 border border-purple-500/30 px-3 py-1 rounded-full text-xs">Physical</span></td><td class="px-6 py-4" data-label="Day">Sunday</td><td class="px-6 py-4 text-white" data-label="Time">8:00 AM - 10:30 AM</td></tr>
                        <tr class="glass-table-row" data-method="physical"><td class="px-6 py-4 font-bold text-white" data-label="Grade">Grade 9</td><td class="px-6 py-4" data-label="Mode"><span class="bg-purple-500/20 text-purple-300 border border-purple-500/30 px-3 py-1 rounded-full text-xs">Physical</span></td><td class="px-6 py-4" data-label="Day">Sunday</td><td class="px-6 py-4 text-white" data-label="Time">11:00 AM - 1:30 PM</td></tr>
                        <tr class="glass-table-row" data-method="online"><td class="px-6 py-4 font-bold text-white" data-label="Grade">Grade 10</td><td class="px-6 py-4" data-label="Mode"><span class="bg-blue-500/20 text-blue-300 border border-blue-500/30 px-3 py-1 rounded-full text-xs">Online</span></td><td class="px-6 py-4" data-label="Day">Monday</td><td class="px-6 py-4 text-white" data-label="Time">3:00 PM - 5:30 PM</td></tr>
                        <tr class="glass-table-row" data-method="physical"><td class="px-6 py-4 font-bold text-white" data-label="Grade">Grade 10</td><td class="px-6 py-4" data-label="Mode"><span class="bg-purple-500/20 text-purple-300 border border-purple-500/30 px-3 py-1 rounded-full text-xs">Physical</span></td><td class="px-6 py-4" data-label="Day">Friday</td><td class="px-6 py-4 text-white" data-label="Time">2:30 PM - 5:00 PM</td></tr>
                        <tr class="glass-table-row" data-method="paper"><td class="px-6 py-4 font-bold text-white" data-label="Grade">Grade 11</td><td class="px-6 py-4" data-label="Mode"><span class="bg-green-500/20 text-green-300 border border-green-500/30 px-3 py-1 rounded-full text-xs">Paper Class</span></td><td class="px-6 py-4" data-label="Day">Wednesday</td><td class="px-6 py-4 text-white" data-label="Time">6:00 PM - 8:00 PM</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="zone-bio" class="relative">
        <div class="video-bg-wrapper"><video autoplay loop muted playsinline><source src="assets/videos/bio-bg.mp4" type="video/mp4"></video><div class="video-overlay"></div></div>
        
     <header class="relative min-h-screen flex items-center pt-24 md:pt-32 pb-40 md:pb-60 overflow-hidden">
            <div class="container mx-auto px-6 relative z-20 h-full flex items-center">
                <div class="text-center md:text-left w-full md:w-1/2" data-aos="fade-right" data-aos-duration="1200">
                    <div class="inline-flex items-center gap-2 liquid-glass px-5 py-2 rounded-full mb-8 border-cyan-500/30">
                        <span class="w-2 h-2 rounded-full bg-cyan-400 animate-pulse"></span>
                        <span class="text-cyan-200 text-xs font-bold tracking-widest uppercase">The Brand of Science</span>
                    </div>
                    
                    <h1 class="text-4xl md:text-7xl lg:text-9xl font-bold text-white leading-[1.1] mb-6 drop-shadow-2xl">
                        <span class="font-serif text-slate-100">තිලක්</span> <br/>
                        <span class="font-serif text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 via-blue-500 to-purple-500 animate-pulse-slow">ජයසිංහ</span>
                    </h1>
                    
                    <p class="text-base md:text-lg text-slate-300 mb-10 leading-relaxed max-w-lg mx-auto md:mx-0 font-light">
                        දශක තුනක අත්දැකීම් සමගින්, විද්‍යාව විෂයට <span class="text-cyan-400 font-bold">A සාමාර්ථයක්</span> සහතික කරන එකම පන්තිය.
                    </p>

                    <div class="flex flex-col sm:flex-row gap-5 justify-center md:justify-start">
                        <button onclick="openTimeTable(this)" class="bg-white text-blue-950 px-8 py-4 rounded-full font-bold shadow-[0_0_30px_rgba(255,255,255,0.4)] hover:shadow-[0_0_50px_rgba(255,255,255,0.7)] hover:-translate-y-1 transition duration-300">Time Table</button>
                        <button id="hero-reg-btn" onclick="openModal(document.getElementById('nav-register-btn'))" class="liquid-glass text-white px-8 py-4 rounded-full font-bold hover:bg-white/10 hover:-translate-y-1 transition duration-300 border-white/20">Enroll Now</button>
                    </div>
                </div>
            </div>

            <div class="relative w-full md:absolute md:right-0 md:bottom-0 md:h-full md:w-1/2 flex items-end justify-center md:justify-end z-10 pointer-events-none" data-aos="fade-left" data-aos-duration="1500" data-aos-delay="200">
                <img src="assets/images/top-image.png" alt="Thilak Jayasinghe" class="relative w-auto h-[50vh] md:h-[90%] max-h-full object-contain drop-shadow-[0_20px_50px_rgba(0,0,0,0.8)] filter contrast-125">
            </div>
        </header>

        <div id="stats-section" class="container mx-auto px-6 relative z-30 -mt-24 mb-24" data-aos="fade-up" data-aos-offset="-100">
            <div class="liquid-glass p-8 md:p-12 rounded-[3rem] flex flex-col md:flex-row justify-around items-center gap-10 text-center backdrop-blur-3xl border border-white/10 shadow-[0_20px_60px_-10px_rgba(0,0,0,0.5)]">
                <div class="group"><div class="text-5xl md:text-6xl font-extrabold text-transparent bg-clip-text bg-gradient-to-b from-white to-slate-400 mb-2 drop-shadow-lg"><span class="counter" data-target="35">0</span>+</div><div class="text-xs font-bold text-cyan-300 uppercase tracking-widest">Years Experience</div></div>
                <div class="block md:hidden w-20 h-px bg-gradient-to-r from-transparent via-white/20 to-transparent"></div>
                <div class="hidden md:block w-px h-20 bg-gradient-to-b from-transparent via-white/20 to-transparent"></div>
                <div class="group"><div class="text-5xl md:text-6xl font-extrabold text-transparent bg-clip-text bg-gradient-to-b from-white to-slate-400 mb-2 drop-shadow-lg"><span class="counter" data-target="30000">0</span>+</div><div class="text-xs font-bold text-cyan-300 uppercase tracking-widest">Successful Students</div></div>
                <div class="block md:hidden w-20 h-px bg-gradient-to-r from-transparent via-white/20 to-transparent"></div>
                <div class="hidden md:block w-px h-20 bg-gradient-to-b from-transparent via-white/20 to-transparent"></div>
                <div class="group"><div class="text-5xl md:text-6xl font-extrabold text-transparent bg-clip-text bg-gradient-to-b from-white to-slate-400 mb-2 drop-shadow-lg">Top</div><div class="text-xs font-bold text-cyan-300 uppercase tracking-widest">District Ranks</div></div>
            </div>
        </div>
    </div>

    <div id="zone-chem" class="relative">
        <div class="video-bg-wrapper"><video autoplay loop muted playsinline loading="lazy"><source src="assets/videos/chem-bg.mp4" type="video/mp4"></video><div class="video-overlay"></div></div>
        <section id="about" class="py-32 relative z-10">
            <div class="container mx-auto px-6">
                <div class="flex flex-col md:flex-row items-center gap-24">
                    <div class="md:w-1/2 relative group" data-aos="zoom-in-right" data-aos-duration="1000">
                        <div class="absolute inset-0 bg-gradient-to-tr from-cyan-500 to-blue-600 rounded-[3rem] rotate-3 opacity-30 blur-2xl group-hover:rotate-6 transition duration-700"></div>
                        <div class="relative rounded-[3rem] overflow-hidden shadow-2xl border border-white/10 aspect-[4/5]">
                            <img src="assets/images/teacher-photo.png" alt="Teacher" class="w-full h-full object-cover transform group-hover:scale-105 transition duration-700">
                        </div>
                    </div>
                    <div class="md:w-1/2" data-aos="fade-left" data-aos-duration="1000">
                        <h2 class="text-xs font-bold text-cyan-400 uppercase tracking-[0.2em] mb-4">The Mentor</h2>
                        <h3 class="text-4xl md:text-6xl font-bold text-white mb-8 leading-tight font-serif">දශක තුනක <br/><span class="text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-cyan-300">විශ්වාසනීය නාමය</span></h3>
                        <p class="text-lg text-slate-300 leading-relaxed text-justify mb-8 font-light">හොරණ ප්‍රදේශයේ විද්‍යා අධ්‍යාපනයේ පුරෝගාමියෙකු වන තිලක් ජයසිංහ මහතා, වසර 30 කට අධික කාලයක් පුරා දහස් ගණනක් දරුවන්ගේ නැණස පාදමින් ඔවුන්ව විශිෂ්ට ප්‍රතිඵල කරා මෙහෙයවා ඇත.</p>
                        <div class="flex flex-col gap-5">
                            <div class="flex items-center gap-5 p-5 liquid-glass rounded-2xl hover:translate-x-2 transition"><div class="w-12 h-12 rounded-full bg-cyan-500/20 flex items-center justify-center text-cyan-400 shadow-[0_0_20px_rgba(6,182,212,0.3)]"><i class="fas fa-brain text-xl"></i></div><span class="font-bold text-slate-200 text-lg">තර්කානුකූල විෂය විග්‍රහය</span></div>
                            <div class="flex items-center gap-5 p-5 liquid-glass rounded-2xl hover:translate-x-2 transition"><div class="w-12 h-12 rounded-full bg-cyan-500/20 flex items-center justify-center text-cyan-400 shadow-[0_0_20px_rgba(6,182,212,0.3)]"><i class="fas fa-microscope text-xl"></i></div><span class="font-bold text-slate-200 text-lg">ප්‍රායෝගික පරීක්ෂණ සහිතයි</span></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="intro-video" class="pb-40 relative z-10" data-aos="fade-up" data-aos-duration="1000">
            <div class="container mx-auto px-6 max-w-5xl">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold text-white mb-4">පන්ති කාමරයෙන් බිඳක්</h2>
                    <div class="w-32 h-1.5 bg-gradient-to-r from-blue-600 to-cyan-400 mx-auto rounded-full"></div>
                </div>
                <div class="liquid-glass p-3 md:p-4 rounded-[2.5rem] border border-cyan-500/30 shadow-[0_0_80px_rgba(6,182,212,0.2)] transform hover:scale-[1.01] transition duration-700">
                    <div class="rounded-[2.2rem] overflow-hidden bg-black relative shadow-inner">
                        <video controls playsinline preload="metadata" class="w-full h-auto block" poster="assets/images/video-thumbnail.jpg"> 
                            <source src="assets/videos/intro.mp4" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
                <div class="text-center mt-8">
                    <p class="text-cyan-200/60 text-xs tracking-[0.3em] uppercase font-bold">Practical Science Education</p>
                </div>
            </div>
        </section>
    </div>

    <section id="student-zone" class="relative py-32 hidden">
        <div class="absolute inset-0 bg-[#020617] z-0"></div>
        <div class="container mx-auto px-6 relative z-10">
            <div class="text-center mb-20" data-aos="fade-down">
                <span class="text-cyan-500 font-bold tracking-widest text-sm uppercase">Welcome to the Classroom</span>
                <h2 class="text-4xl md:text-5xl font-bold text-white mt-2">Exclusive Video Lessons</h2>
            </div>
            
            <div class="grid md:grid-cols-2 gap-10">
                <div class="liquid-glass p-5 rounded-[2rem] hover:-translate-y-2 transition duration-500 border-t border-white/20" data-aos="fade-up" data-aos-delay="100">
                    <div class="video-container mb-6 shadow-2xl">
                        <iframe src="https://www.youtube.com/embed/ScMzIvxBSi4" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                    </div>
                    <div class="flex items-center gap-4">
                        <div class="w-10 h-10 rounded-full bg-red-600 flex items-center justify-center text-white shadow-lg"><i class="fas fa-play"></i></div>
                        <h3 class="text-2xl font-bold text-white">Chemical Bonding Basics</h3>
                    </div>
                </div>
                <div class="liquid-glass p-5 rounded-[2rem] hover:-translate-y-2 transition duration-500 border-t border-white/20" data-aos="fade-up" data-aos-delay="200">
                    <div class="video-container mb-6 shadow-2xl">
                        <iframe src="https://www.youtube.com/embed/3k0j0h4f8gM" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                    </div>
                    <div class="flex items-center gap-4">
                        <div class="w-10 h-10 rounded-full bg-red-600 flex items-center justify-center text-white shadow-lg"><i class="fas fa-play"></i></div>
                        <h3 class="text-2xl font-bold text-white">Motion & Force</h3>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="teacher-zone" class="relative py-32 hidden bg-[#020617] min-h-screen">
        <div class="absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none">
            <div class="absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-orange-500/10 rounded-full blur-[120px]"></div>
        </div>
        <div class="container mx-auto px-6 relative z-10">
            <div class="flex flex-col md:flex-row justify-between items-end mb-10 pb-6 border-b border-white/10">
                <div>
                    <h2 class="text-4xl font-bold text-white">Teacher Dashboard</h2>
                    <p class="text-slate-400 mt-2">Manage Registered Students</p>
                </div>
                <div class="mt-6 md:mt-0 relative w-full md:w-96">
                    <i class="fas fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-400"></i>
                    <input type="text" id="admin-search" onkeyup="handleSearch()" placeholder="Search by Name or Phone..." class="water-input w-full pl-12 pr-5 py-3 rounded-full focus:ring-0 bg-white/5 border-white/10">
                </div>
            </div>

            <div class="liquid-glass rounded-[2rem] p-8 overflow-hidden border border-white/10 shadow-[0_0_50px_rgba(0,0,0,0.5)]">
                <div class="overflow-x-auto custom-scrollbar">
                    <table class="w-full text-left text-sm text-slate-300">
                        <thead class="text-xs uppercase bg-white/5 text-orange-400 font-bold tracking-wider">
                            <tr>
                                <th class="px-6 py-5 rounded-l-xl">Name</th>
                                <th class="px-6 py-5">Phone</th>
                                <th class="px-6 py-5">Grade</th>
                                <th class="px-6 py-5">Method</th>
                                <th class="px-6 py-5">Joined</th>
                                <th class="px-6 py-5 rounded-r-xl text-center">Action</th>
                            </tr>
                        </thead>
                        <tbody id="student-table-body" class="divide-y divide-white/5">
                            <tr><td colspan="6" class="text-center py-12 text-slate-500"><i class="fas fa-circle-notch fa-spin text-2xl mb-2 text-orange-500"></i><br>Loading Database...</td></tr>
                        </tbody>
                    </table>
                </div>
                <div class="mt-6 pt-4 border-t border-white/5 text-right text-xs text-slate-500 font-mono" id="student-count">Records: 0</div>
            </div>
        </div>
    </section>

    <div id="zone-phy" class="relative">
        <div class="video-bg-wrapper"><video autoplay loop muted playsinline loading="lazy"><source src="assets/videos/phy-bg.mp4" type="video/mp4"></video><div class="video-overlay"></div></div>
        <section id="classes" class="py-32 relative z-10">
            <div class="container mx-auto px-6">
                <div class="text-center mb-24" data-aos="fade-up">
                    <h2 class="text-4xl md:text-5xl font-bold text-white mb-4">අපගේ පාඨමාලා</h2>
                    <div class="w-24 h-1.5 bg-gradient-to-r from-blue-600 to-cyan-400 mx-auto rounded-full"></div>
                </div>
                <div class="grid md:grid-cols-3 gap-10">
                    
                    <div class="liquid-glass rounded-[2.5rem] p-10 hover:-translate-y-4 transition duration-500 group border-t border-white/10" data-aos="fade-up" data-aos-delay="0">
                        <div class="w-20 h-20 bg-white/5 rounded-3xl flex items-center justify-center mb-8 border border-white/10 group-hover:bg-cyan-500/20 group-hover:scale-110 transition duration-500 shadow-lg">
                            <i class="fas fa-shapes text-4xl text-cyan-300"></i>
                        </div>
                        <h3 class="text-3xl font-bold mb-4 text-white">6 - 11 ශ්‍රේණි</h3>
                        <p class="text-slate-300 mb-10 leading-relaxed font-light">පාසල් විෂය නිර්දේශය ආවරණය කරමින්, විද්‍යාත්මක සංකල්ප සරලව සහ රසවත්ව ඉගැන්වීම.</p>
                        <button onclick="openModal(this)" class="inline-flex items-center text-cyan-300 font-bold hover:gap-3 transition-all tracking-wide">Enroll Now <i class="fas fa-arrow-right ml-2 text-sm"></i></button>
                    </div>

                    <div class="liquid-glass rounded-[2.5rem] p-10 transform md:-translate-y-8 relative overflow-hidden group border-cyan-500/30 shadow-[0_0_60px_rgba(6,182,212,0.15)] bg-gradient-to-b from-white/5 to-transparent" data-aos="fade-up" data-aos-delay="150">
                        <div class="absolute top-0 right-0 w-40 h-40 bg-cyan-400/20 rounded-full blur-[60px] -mr-10 -mt-10"></div>
                        <div class="relative z-10">
                            <div class="w-20 h-20 bg-gradient-to-br from-cyan-400 to-blue-600 rounded-3xl flex items-center justify-center mb-8 shadow-xl group-hover:scale-110 transition duration-500">
                                <i class="fas fa-laptop-code text-4xl text-white"></i>
                            </div>
                            <h3 class="text-3xl font-bold mb-4 text-white">ONLINE Classes (Theory)</h3>
                            <p class="text-slate-200 mb-10 leading-relaxed font-light">මුළු දිවයිනම ආවරණය වන පරිදි, Zoom තාක්ෂණය ඔස්සේ නිවසේ සිටම සම්බන්ධ වන්න.</p>
                            <button onclick="openModal(this, 'online')" class="inline-block w-full py-4 rounded-2xl bg-white text-blue-950 font-bold text-center hover:bg-cyan-50 transition shadow-lg hover:shadow-cyan-500/20">Register Now</button>
                        </div>
                    </div>

                    <div class="liquid-glass rounded-[2.5rem] p-10 hover:-translate-y-4 transition duration-500 group border-t border-white/10" data-aos="fade-up" data-aos-delay="300">
                        <div class="w-20 h-20 bg-white/5 rounded-3xl flex items-center justify-center mb-8 border border-white/10 group-hover:bg-cyan-500/20 group-hover:scale-110 transition duration-500 shadow-lg">
                            <i class="fas fa-file-contract text-4xl text-cyan-300"></i>
                        </div>
                        <h3 class="text-3xl font-bold mb-4 text-white">Paper class (Online)</h3>
                        <p class="text-slate-300 mb-10 leading-relaxed font-light">පසුගිය විභාග ප්‍රශ්න පත්‍ර සාකච්ඡාව, ආදර්ශ ප්‍රශ්න පත්‍ර සහ කාල කළමනාකරණය.</p>
                        <button onclick="openModal(this)" class="inline-flex items-center text-cyan-300 font-bold hover:gap-3 transition-all tracking-wide">Enroll Now <i class="fas fa-arrow-right ml-2 text-sm"></i></button>
                    </div>

                </div>
            </div>
        </section>
        <footer class="bg-[#020617] border-t border-white/5 py-16 relative z-10">
            <div class="container mx-auto px-6 flex flex-col md:flex-row justify-between items-center gap-8">
                <div class="text-center md:text-left">
                    <h2 class="text-3xl font-bold text-white tracking-tight">තිලක් ජයසිංහ</h2>
                    <p class="text-slate-500 text-sm mt-2 tracking-widest uppercase">Premium Science Education (6-11)</p>
                </div>
                <div class="flex gap-6">
                    <a href="#" class="w-12 h-12 rounded-full bg-white/5 border border-white/5 flex items-center justify-center text-slate-400 hover:bg-blue-600 hover:text-white hover:border-blue-500 hover:-translate-y-1 transition duration-300"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" class="w-12 h-12 rounded-full bg-white/5 border border-white/5 flex items-center justify-center text-slate-400 hover:bg-red-600 hover:text-white hover:border-red-500 hover:-translate-y-1 transition duration-300"><i class="fab fa-youtube"></i></a>
                    <a href="#" class="w-12 h-12 rounded-full bg-white/5 border border-white/5 flex items-center justify-center text-slate-400 hover:bg-green-600 hover:text-white hover:border-green-500 hover:-translate-y-1 transition duration-300"><i class="fab fa-whatsapp"></i></a>
                </div>
                <p class="text-slate-600 text-sm">&copy; 2025 Thilak Jayasinghe. All Rights Reserved.</p>
            </div>
        </footer>
    </div>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        AOS.init({ once: true, offset: 50, duration: 800, easing: 'ease-out-cubic' });
    </script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, setDoc, getDoc, collection, getDocs, deleteDoc, addDoc, onSnapshot, query, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // --- 1. FIREBASE CONFIG ---
        const firebaseConfig = {
            apiKey: "AIzaSyBLdOjUVHrOMh1RCMl_mOViSkHABH-Rmb8",
            authDomain: "thilak-jayasinghe-science.firebaseapp.com",
            projectId: "thilak-jayasinghe-science",
            storageBucket: "thilak-jayasinghe-science.firebasestorage.app",
            messagingSenderId: "821871741202",
            appId: "1:821871741202:web:d30b27fd6db48fc4998bcb",
            measurementId: "G-MYGJ4D9QZB"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // --- 2. CONFIG DATA ---
        const groupLinks = {
            "6": { "online": "https://chat.whatsapp.com/G6_ON", "physical": "https://chat.whatsapp.com/G6_PHY" },
            "7": { "online": "https://chat.whatsapp.com/G7_ON", "physical": "https://chat.whatsapp.com/G7_PHY" },
            "8": { "online": "https://chat.whatsapp.com/G8_ON", "physical": "https://chat.whatsapp.com/G8_PHY" },
            "9": { "online": "https://chat.whatsapp.com/G9_ON", "physical": "https://chat.whatsapp.com/G9_PHY" },
            "10": { "online": "https://chat.whatsapp.com/G10_ON", "physical": "https://chat.whatsapp.com/G10_PHY" },
            "11": { "online": "https://chat.whatsapp.com/G11_ON", "physical": "https://chat.whatsapp.com/G11_PHY" }
        };

        let pendingLink = ""; 
        let activeAnnouncements = [];

        // --- 3. ANNOUNCEMENT SYSTEM LOGIC ---
        
        // Listen for all active announcements in real-time
        const announceCollection = collection(db, "announcements");
        const q = query(announceCollection); // You can add orderBy('date', 'desc') here if you index it

        onSnapshot(q, (snapshot) => {
            activeAnnouncements = [];
            snapshot.forEach(doc => {
                activeAnnouncements.push({ id: doc.id, ...doc.data() });
            });

            // Sort manually to be safe (Newest First)
            activeAnnouncements.sort((a, b) => {
                const dateA = a.date?.toDate ? a.date.toDate() : new Date(0);
                const dateB = b.date?.toDate ? b.date.toDate() : new Date(0);
                return dateB - dateA; 
            });

            if (activeAnnouncements.length > 0) {
                // 1. Activate Blinking Dots
                document.getElementById('nav-announce-btn').classList.remove('hidden');
                document.getElementById('announce-dot').classList.remove('hidden');
                document.getElementById('mobile-announce-btn').classList.remove('hidden');
                document.getElementById('mobile-announce-dot').classList.remove('hidden');

                // 2. Auto-Popup Logic (Check newest only)
                const userRole = JSON.parse(localStorage.getItem('user'))?.role;
                const newestId = activeAnnouncements[0].id;
                
                if (userRole !== 'admin' && !sessionStorage.getItem('seen_announce_' + newestId)) {
                    // Update Guest UI before showing
                    updateGuestAnnouncementList();
                    
                    // Trigger Modal
                    const overlay = document.getElementById('announce-overlay');
                    const content = document.getElementById('announce-content');
                    overlay.classList.remove('hidden');
                    setTimeout(() => {
                        overlay.classList.remove('opacity-0');
                        content.classList.remove('scale-90', 'opacity-0');
                        content.classList.add('scale-100', 'opacity-100');
                    }, 500);

                    // Mark newest as seen
                    sessionStorage.setItem('seen_announce_' + newestId, 'true');
                }

                // If Admin Panel is open, refresh
                if(document.getElementById('admin-announce-overlay').classList.contains('hidden') === false) {
                    renderAdminList();
                }

            } else {
                // No Active Announcements
                document.getElementById('announce-dot').classList.add('hidden');
                document.getElementById('mobile-announce-dot').classList.add('hidden');
                
                // Hide button for guests
                const user = JSON.parse(localStorage.getItem('user'));
                if (!user || user.role !== 'admin') {
                    document.getElementById('nav-announce-btn').classList.add('hidden');
                    document.getElementById('mobile-announce-btn').classList.add('hidden');
                }

                if(document.getElementById('admin-announce-overlay').classList.contains('hidden') === false) {
                    renderAdminList();
                }
            }
        });

        // Global functions
        window.openAnnouncement = function() {
            const user = JSON.parse(localStorage.getItem('user'));
            
            // ADMIN LOGIC
            if (user && user.role === 'admin') {
                const overlay = document.getElementById('admin-announce-overlay');
                const content = document.getElementById('admin-announce-content');
                overlay.classList.remove('hidden');
                setTimeout(() => {
                    overlay.classList.remove('opacity-0');
                    content.classList.remove('scale-90', 'opacity-0');
                    content.classList.add('scale-100', 'opacity-100');
                }, 10);
                renderAdminList();
            } 
            // GUEST LOGIC
            else if (activeAnnouncements.length > 0) {
                updateGuestAnnouncementList();
                const overlay = document.getElementById('announce-overlay');
                const content = document.getElementById('announce-content');
                overlay.classList.remove('hidden');
                setTimeout(() => {
                    overlay.classList.remove('opacity-0');
                    content.classList.remove('scale-90', 'opacity-0');
                    content.classList.add('scale-100', 'opacity-100');
                }, 10);
            }
        };

        function updateGuestAnnouncementList() {
            const container = document.getElementById('announce-list-container');
            let html = "";
            activeAnnouncements.forEach(item => {
                const date = item.date?.toDate ? item.date.toDate().toLocaleDateString() : "New";
                html += `
                    <div class="bg-white/5 rounded-xl p-4 border border-white/10 hover:border-red-500/30 transition">
                        <p class="text-slate-200 text-sm font-medium leading-relaxed mb-2">${item.text}</p>
                        <p class="text-[10px] text-slate-500 font-mono uppercase tracking-widest text-right">${date}</p>
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        window.closeAnnouncement = function() {
            const overlay = document.getElementById('announce-overlay');
            const content = document.getElementById('announce-content');
            content.classList.remove('scale-100', 'opacity-100');
            content.classList.add('scale-90', 'opacity-0');
            overlay.classList.add('opacity-0');
            setTimeout(() => overlay.classList.add('hidden'), 300);
        };

        window.closeAdminAnnouncement = function() {
            const overlay = document.getElementById('admin-announce-overlay');
            const content = document.getElementById('admin-announce-content');
            content.classList.remove('scale-100', 'opacity-100');
            content.classList.add('scale-90', 'opacity-0');
            overlay.classList.add('opacity-0');
            setTimeout(() => overlay.classList.add('hidden'), 300);
        };

        window.publishAnnouncement = async function() {
            const text = document.getElementById('new-announce-text').value.trim();
            if (!text) return alert("Please type a message.");

            try {
                // Just ADD, don't delete old ones
                await addDoc(collection(db, "announcements"), {
                    text: text,
                    date: new Date()
                });
                document.getElementById('new-announce-text').value = "";
                alert("Announcement Published!");
            } catch (e) {
                console.error(e);
                alert("Error publishing.");
            }
        };

        window.deleteAnnouncement = async function(id) {
            if(confirm("Delete this announcement?")) {
                await deleteDoc(doc(db, "announcements", id));
            }
        };

        function renderAdminList() {
            const container = document.getElementById('active-announce-list');
            if (activeAnnouncements.length === 0) {
                container.innerHTML = '<p class="text-slate-500 text-sm text-center">No active announcements.</p>';
                return;
            }
            let html = "";
            activeAnnouncements.forEach(item => {
                const date = item.date?.toDate ? item.date.toDate().toLocaleDateString() : "-";
                html += `
                    <div class="bg-white/5 border border-white/10 rounded-xl p-4 flex justify-between items-center gap-4">
                        <div class="overflow-hidden">
                            <div class="text-sm text-slate-300 font-medium truncate">${item.text}</div>
                            <div class="text-[10px] text-slate-500 font-mono mt-1">${date}</div>
                        </div>
                        <button onclick="deleteAnnouncement('${item.id}')" class="text-red-400 hover:text-white hover:bg-red-500 px-3 py-2 border border-red-500/30 rounded-lg transition text-xs font-bold shrink-0">DELETE</button>
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        // --- 4. EXISTING LOGIC (Registration, Login, Data) ---
        window.handleRegistration = async function(event) {
            event.preventDefault();
            const btn = document.getElementById('reg-submit-btn');
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...'; 
            btn.disabled = true;

            const name = document.getElementById('reg-name').value.trim();
            const whatsapp = document.getElementById('reg-whatsapp').value.trim().replace(/\s/g, ''); 
            const grade = document.getElementById('reg-grade').value;
            const method = document.getElementById('reg-method').value;

            const username = whatsapp + grade; 
            
            let password = username;
            if (username.length >= 4) {
                password = username.substring(0, 2) + username.substring(username.length - 2);
            }

            try {
                const studentRef = doc(db, "students", username);
                const docSnap = await getDoc(studentRef);

                if (docSnap.exists()) {
                    alert("This phone number is ALREADY registered for Grade " + grade + ".\nPlease Log In instead.");
                    btn.innerText = "Register Now"; btn.disabled = false;
                    return;
                }

                await setDoc(studentRef, {
                    name, whatsapp, grade, method, username, password, createdAt: new Date()
                });

                document.getElementById('cred-username').innerText = username;
                document.getElementById('cred-password').innerText = password;

                pendingLink = groupLinks[grade] ? groupLinks[grade][method] : "";

                window.closeModal();
                setTimeout(() => {
                    const overlay = document.getElementById('cred-overlay');
                    const content = document.getElementById('cred-content');
                    overlay.classList.remove('hidden');
                    setTimeout(() => {
                        overlay.classList.remove('opacity-0');
                        content.classList.remove('scale-90', 'opacity-0');
                        content.classList.add('scale-100', 'opacity-100');
                    }, 50);
                }, 300);
            } catch (e) {
                alert("Error saving data: " + e.message);
            } finally {
                btn.innerText = "Register Now"; btn.disabled = false;
            }
        };

        window.handleLogin = async function(event) {
            event.preventDefault();
            const btn = document.getElementById('login-submit-btn');
            const userIn = document.getElementById('login-username').value.trim();
            const passIn = document.getElementById('login-password').value.trim();

            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Verifying...';

            // ADMIN CHECK
            if (userIn === "0718046043" && passIn === "1970") {
                const adminData = { name: "Thilak Jayasinghe", role: "admin" };
                localStorage.setItem('user', JSON.stringify(adminData));
                window.loginSuccess(adminData);
                window.closeLogin();
                btn.innerText = "Login Securely";
                return;
            }

            // STUDENT CHECK
            try {
                const docSnap = await getDoc(doc(db, "students", userIn));
                if (docSnap.exists()) {
                    const data = docSnap.data();
                    if (data.password === passIn) {
                        const userData = { 
                            name: data.name, 
                            username: data.username,
                            grade: data.grade,    
                            method: data.method,
                            role: "student"
                        };
                        localStorage.setItem('user', JSON.stringify(userData));
                        window.loginSuccess(userData);
                        window.closeLogin();
                    } else {
                        alert("Incorrect Password.");
                    }
                } else {
                    alert("User not found.");
                }
            } catch (e) {
                alert("Error logging in: " + e.message);
            } finally {
                btn.innerText = "Login Securely";
            }
        };

        window.loadAdminData = async function() {
            const tableBody = document.getElementById('student-table-body');
            const countLabel = document.getElementById('student-count');
            
            tableBody.innerHTML = '<tr><td colspan="6" class="text-center py-12 text-slate-500"><i class="fas fa-spinner fa-spin text-2xl mb-2 text-cyan-500"></i><br>Loading Database...</td></tr>';
            
            try {
                const querySnapshot = await getDocs(collection(db, "students"));
                let html = "";
                let count = 0;
                
                querySnapshot.forEach((docSnap) => {
                    const s = docSnap.data();
                    const joined = s.createdAt && s.createdAt.toDate ? s.createdAt.toDate().toLocaleDateString() : "N/A";
                    const docId = docSnap.id; 

                    html += `
                        <tr class="glass-table-row hover:bg-white/5 transition duration-300">
                            <td class="px-6 py-4 font-bold text-white">${s.name}</td>
                            <td class="px-6 py-4 font-mono text-cyan-300">${s.whatsapp}</td>
                            <td class="px-6 py-4"><span class="bg-slate-800 border border-slate-700 px-3 py-1 rounded-full text-xs font-bold text-slate-300">Grade ${s.grade}</span></td>
                            <td class="px-6 py-4 capitalize text-slate-300">${s.method}</td>
                            <td class="px-6 py-4 text-xs text-slate-500 font-mono">${joined}</td>
                            <td class="px-6 py-4 text-center">
                                <button onclick="deleteStudent('${docId}')" class="text-red-400 hover:text-white hover:bg-red-500 p-2.5 rounded-xl transition duration-300 shadow-lg" title="Remove Student">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                            </td>
                        </tr>
                    `;
                    count++;
                });

                const thead = document.querySelector('#teacher-zone table thead tr');
                if (thead.children.length === 5) {
                   thead.innerHTML += '<th class="px-6 py-5 rounded-r-xl text-center">Action</th>';
                }

                tableBody.innerHTML = html || '<tr><td colspan="6" class="text-center py-12 text-slate-500">No students found.</td></tr>';
                countLabel.innerText = "Total Records: " + count;

            } catch (e) {
                console.error(e);
                tableBody.innerHTML = '<tr><td colspan="6" class="text-center py-12 text-red-400">Error loading data.</td></tr>';
            }
        };

        window.deleteStudent = async function(docId) {
            if (!confirm("Are you sure you want to delete this student?\nThis action cannot be undone.")) {
                return;
            }

            try {
                await deleteDoc(doc(db, "students", docId));
                alert("Student removed successfully.");
                window.loadAdminData();
            } catch (e) {
                console.error("Error removing document: ", e);
                alert("Error removing student: " + e.message);
            }
        };

        window.finalizeRegistration = function() {
            if (pendingLink && pendingLink.startsWith("http")) window.open(pendingLink, '_blank');
            else alert("Group link not configured.");
            
            document.getElementById('cred-overlay').classList.add('opacity-0');
            setTimeout(() => document.getElementById('cred-overlay').classList.add('hidden'), 300);
        };

        window.globalGroupLinks = groupLinks;
    </script>
    <script>
        const statsSection = document.querySelector('#stats-section');
        const modalOverlay = document.getElementById('modal-overlay');
        const modalContent = document.getElementById('modal-content');
        const methodSection = document.getElementById('method-section');
        const methodDropdown = document.getElementById('reg-method');
        const credOverlay = document.getElementById('cred-overlay');
        const credContent = document.getElementById('cred-content');
        const loginOverlay = document.getElementById('login-overlay');
        const loginContent = document.getElementById('login-content');
        const timetableOverlay = document.getElementById('timetable-overlay');
        const timetableContent = document.getElementById('timetable-content');
        const contactOverlay = document.getElementById('contact-overlay');
        const contactContent = document.getElementById('contact-content');
        const mobileMenu = document.getElementById('mobile-menu');
        
        // New Overlays
        const announceOverlay = document.getElementById('announce-overlay');
        const adminAnnounceOverlay = document.getElementById('admin-announce-overlay');

        // Navigation UI Logic
        const navLoginBtn = document.getElementById('nav-login-btn');
        const navUserProfile = document.getElementById('nav-user-profile');
        const navRegContainer = document.getElementById('nav-reg-container');
        const heroRegBtn = document.getElementById('hero-reg-btn');
        const userNameDisplay = document.getElementById('user-name-display');
        const studentZone = document.getElementById('student-zone');
        const teacherZone = document.getElementById('teacher-zone');
        const navAnnounceBtn = document.getElementById('nav-announce-btn');
        
        // Mobile UI Logic
        const mobileLoginBtn = document.getElementById('mobile-login-btn');
        const mobileRegBtn = document.getElementById('mobile-reg-btn');
        const mobileUserProfile = document.getElementById('mobile-user-profile');
        const mobileUserNameDisplay = document.getElementById('mobile-username-display');
        const mobileAnnounceBtn = document.getElementById('mobile-announce-btn');

        // Check Login State on Load
        window.onload = function() {
            const storedUser = localStorage.getItem('user');
            if (storedUser) {
                loginSuccess(JSON.parse(storedUser));
            }
        };

        function toggleMobileMenu() {
            if (mobileMenu.classList.contains('translate-x-full')) {
                mobileMenu.classList.remove('hidden');
                setTimeout(() => mobileMenu.classList.remove('translate-x-full'), 10);
            } else {
                mobileMenu.classList.add('translate-x-full');
                setTimeout(() => mobileMenu.classList.add('hidden'), 300);
            }
        }

        function loginSuccess(user) {
            // Desktop UI Updates
            navLoginBtn.classList.add('hidden'); 
            navRegContainer.classList.add('hidden'); 
            if(heroRegBtn) heroRegBtn.classList.add('hidden'); 
            navUserProfile.classList.remove('hidden'); 
            userNameDisplay.innerText = user.name.split(' ')[0]; 
            
            // Mobile UI Updates
            mobileLoginBtn.classList.add('hidden');
            mobileRegBtn.classList.add('hidden');
            mobileUserProfile.classList.remove('hidden');
            mobileUserNameDisplay.innerText = user.name.split(' ')[0];
            
            // ROLE BASED UI
            if (user.role === 'admin') {
                teacherZone.classList.remove('hidden');
                studentZone.classList.add('hidden');
                // Admin always sees announce button
                navAnnounceBtn.classList.remove('hidden'); 
                mobileAnnounceBtn.classList.remove('hidden');
                document.getElementById('announce-dot-static').classList.remove('hidden');
                document.getElementById('announce-dot').classList.add('hidden'); // No pulse for admin, just static indicator
                
                if (window.loadAdminData) window.loadAdminData();
            } else {
                studentZone.classList.remove('hidden');
                teacherZone.classList.add('hidden');

                if (user.grade && user.method && window.globalGroupLinks) {
                    const link = window.globalGroupLinks[user.grade] ? window.globalGroupLinks[user.grade][user.method] : null;
                    if (link) {
                        const floatBtn = document.getElementById('floating-wa-btn');
                        floatBtn.href = link; 
                        floatBtn.classList.remove('hidden'); 
                    }
                }
            }
        }

        function handleLogout() {
            localStorage.removeItem('user');
            location.reload();
        }

        // --- Admin Search Logic ---
        function handleSearch() {
            const input = document.getElementById('admin-search');
            const filter = input.value.toUpperCase();
            const table = document.getElementById('student-table-body');
            const tr = table.getElementsByTagName('tr');

            for (let i = 0; i < tr.length; i++) {
                const tdName = tr[i].getElementsByTagName('td')[0];
                const tdPhone = tr[i].getElementsByTagName('td')[1];
                
                if (tdName && tdPhone) {
                    const txtName = tdName.textContent || tdName.innerText;
                    const txtPhone = tdPhone.textContent || tdPhone.innerText;
                    
                    if (txtName.toUpperCase().indexOf(filter) > -1 || txtPhone.toUpperCase().indexOf(filter) > -1) {
                        tr[i].style.display = "";
                    } else {
                        tr[i].style.display = "none";
                    }
                }       
            }
        }

        // --- Helpers ---
        function moveBubble(element) {
            const navContainer = document.getElementById('main-nav');
            const bubble = document.getElementById('nav-bubble');
            const navRect = navContainer.getBoundingClientRect();
            const elemRect = element.getBoundingClientRect();
            bubble.style.width = elemRect.width + 'px';
            bubble.style.left = (elemRect.left - navRect.left) + 'px';
            bubble.style.opacity = '1';
            document.querySelectorAll('.nav-item').forEach(l => {l.classList.remove('text-white'); l.classList.add('text-slate-400');});
            element.classList.remove('text-slate-400'); element.classList.add('text-white');
        }

        function animateModalOpen(element, btnElement) {
            element.classList.remove('hidden');
            const content = element.querySelector('.modal-bubble') || element.querySelector('.liquid-glass'); 
            if(!content) return;
            
            content.style.transformOrigin = 'center center';
            requestAnimationFrame(() => {
                element.classList.remove('opacity-0');
                content.classList.remove('scale-90', 'opacity-0');
                content.classList.add('scale-100', 'opacity-100');
            });
        }

        function openModal(btn, method = null) {
            if (method === 'online') {
                methodSection.classList.add('hidden');
                methodDropdown.value = 'online';
            } else {
                methodSection.classList.remove('hidden');
                methodDropdown.value = "";
            }
            animateModalOpen(modalOverlay, btn);
        }

        function closeModal() { closeAny(modalOverlay); }
        function openLogin(btn) { animateModalOpen(loginOverlay, btn); }
        function closeLogin() { closeAny(loginOverlay); }
        function openTimeTable(btn) { animateModalOpen(timetableOverlay, btn); }
        function closeTimeTable() { closeAny(timetableOverlay); }
        function openContact() { animateModalOpen(contactOverlay); }
        function closeContact() { closeAny(contactOverlay); }

        function closeAny(ov) {
            ov.classList.add('opacity-0');
            const c = ov.querySelector('.modal-bubble') || ov.querySelector('.liquid-glass');
            if(c) {
                c.classList.remove('scale-100', 'opacity-100');
                c.classList.add('scale-90', 'opacity-0');
            }
            setTimeout(() => ov.classList.add('hidden'), 300);
        }

        function filterTimetable() {
            const v = document.getElementById('timetable-filter').value;
            document.querySelectorAll('#timetable-body tr').forEach(r => {
                const m = r.getAttribute('data-method');
                if (v === 'all' || m === v) r.classList.remove('hidden-row');
                else r.classList.add('hidden-row');
            });
        }

        [modalOverlay, credOverlay, loginOverlay, timetableOverlay, contactOverlay, announceOverlay, adminAnnounceOverlay].forEach(ov => {
            if(ov) ov.addEventListener('click', (e) => { if(e.target===ov) closeAny(ov); });
        });

        if (statsSection) {
            const obs = new IntersectionObserver((es) => {
                if (es[0].isIntersecting) {
                    document.querySelectorAll('.counter').forEach(c => {
                        const t = +c.getAttribute('data-target');
                        let cur = 0;
                        const upd = () => {
                            cur += t / 100;
                            if (cur < t) { c.innerText = Math.ceil(cur); requestAnimationFrame(upd); }
                            else c.innerText = t;
                        };
                        upd();
                    });
                    obs.disconnect();
                }
            });
            obs.observe(statsSection);
        }
    </script>
</body>
</html>